<html>
<head>
	<title>feather</title>
	<script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
	<script src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script>


	<style type="text/css">
	.stuff{
		height: 500px;
		background-color: #333;
		color: #fff;
	}


	</style>
</head>
<body>

	<div class="stuff"> Scroll Down ....</div>

	<div class="feather">

		

		<svg
		   width="322.80206"
		   height="367.15784"		   
		   version="1.1"
		   sodipodi:docname="feather_op.svg">
		  <defs
		     id="defs4">
		    <filter
		       inkscape:collect="always"
		       id="filter3840"
		       color-interpolation-filters="sRGB">
		      <feGaussianBlur
		         inkscape:collect="always"
		         stdDeviation="1.2011009"
		         id="feGaussianBlur3842" />
		    </filter>
		  </defs>

		  <g transform="translate(-1040.0456,-459.68559)">
		    <path
		       style="opacity:0.53982299;fill:none;stroke:#05371f;stroke-width:5;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:0.94117647;stroke-dasharray:none;filter:url(#filter3840)"
		       d="m 1050.7846,679.63118 c -20.6917,-56.65424 -12.4358,-130.70269 13.4115,-182.39731 26.015,-52.03001 48.6435,-5.36463 48.2817,-5.36463 -12.1612,0 5.2906,-23.99283 10.7292,-34.87008 34.2604,-68.52068 109.9489,-67.03183 160.9388,-118.02179 17.8695,-17.86951 55.124,-22.93619 72.4225,-40.2347 9.3987,-9.39874 20.1067,-36.22187 29.5054,-26.82314 6.2108,6.21078 -11.2726,177.57607 -13.4115,179.71501 -11.057,11.05694 -35.9736,14.51508 -48.2817,26.82313 -2.1993,2.19937 34.3779,4.38032 34.8701,5.36463 3.9627,7.92536 -5.9185,38.10627 -10.7293,42.91701 -14.2406,14.24069 -95.7011,41.19283 -99.2456,48.28165 -10.7277,21.45549 31.4679,4.6447 37.5524,10.72925 13.9084,13.90833 -21.8157,61.69321 -34.87,61.69321 -16.6814,0 -94.4435,32.75022 -104.6103,42.91702 -36.04,36.04005 -54.8133,89.68345 -93.8809,128.75105 -20.6142,20.61422 -29.5055,48.36782 -29.5055,48.28164 0,-86.26939 115.3858,-276.37094 160.9388,-367.47695 4.3941,-8.78816 116.5354,-54.26112 131.4334,-128.75105" 

		       stroke-dasharray=""
		       stroke-dashoffset="0.00"

		       inkscape:connector-curvature="0"
		       
		       transform="matrix(0.86263378,0,0,0.60499164,161.37882,299.6264)" />
		  </g>
		</svg>
	</div>


	<div class="stuff"></div>


	<script type="text/javascript">

	$(document).ready(function(){
	//get the length of the SVG , not entirely necessary but makes things more precise
		var path = document.querySelector('path');
		var length= path.getTotalLength(); //2105.057...

		// Clear any previous transition
		path.style.transition = path.style.WebkitTransition ='none';
		
		// Set up the starting positions
		path.style.strokeDasharray = length + ' ' + length;
		path.style.strokeDashoffset = length;

		// Trigger a layout so styles are calculated & the browser
		// picks up the starting position before animating
		path.getBoundingClientRect();

		// // Define a transition (if u just want it to appear)
		// path.style.transition = path.style.WebkitTransition = 'stroke-dashoffset 6s ease-in';

		// Animate on scroll event
		$(window).scroll(function () {
			

				//store the dashoffset value, initilly the length, amount by which the stroke is hidden/visible
			var dashOffset = length;


				//keeping track of the top of the viewport, the window height, the top of the SVG and the middle of the SVG

				var scroll = $(window).scrollTop();
				var svgTop = $(".feather").offset().top;
				var windowheight = $(window).height();
				var svgMidPoint = $(".feather").height()/2;


				//calculate what percentage of the line should be drawn based on where on the page the viewpoint is.
				// we want it to start drawing when the svg just starts to appear at the bottom of the screen, and it should be 100% drawn when it is right in the centre of the screen
		    var offsetPercentage =  (( (scroll) - svgTop  ) / ( svgTop + svgMidPoint)) - 1; 

		    dashOffset -= (length * offsetPercentage); 


		    console.log("new offset: " + dashOffset);
		    console.log("scroll top: " + scroll);

		    path.style.strokeDashoffset = dashOffset; //start drawing!

 		

		});


//dash offset should be > than the length of the SVG path when the scrolltop is less than X and greater than y

// i.e. if path.offset.top > window.height, no show, when it's less start to draw, until scrolltop is at path.height/2 meaning in the middle of the image. 

//so the RANGE of drawing time is path.top > scrolltop + window height. and path.top < scrolltop + windowheight - 

//once the SVG is visible, because the scroll has gone past a certain point, begin to reduce the offset by a given amount at each scroll i.e. some percentage of the length, such that at 100% of length the svg is in the centre of the screen
		
	})



	</script>
</body>
</html>